#!/usr/bin/env bash

set -euo pipefail

# COLORS
export OFF='\033[0m'
export RED='\033[0;31m'
export GREEN='\033[0;32m'
export BLUE='\033[0;34m'
export PURPLE='\033[0;35m'
export YELLOW='\033[0;33m'

# set the working directory to the root of the project
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && cd .. && pwd )"
export DIR

# The name of the repository is the name of the directory (usually)
REPO_NAME=$(basename "$PWD")
export REPO_NAME

if [[ -z "${GIT_SHA:-}" ]]; then
  if command -v git >/dev/null 2>&1 && [[ -d "$DIR/.git" ]]; then
    GIT_SHA=$(git -C "$DIR" rev-parse --short=8 HEAD 2>/dev/null || true)
  fi
fi

if [[ -z "${GIT_SHA:-}" ]]; then
  GIT_SHA="unknown"
fi

export GIT_SHA
